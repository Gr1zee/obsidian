---
id: Tests
created_date: 2025-10-13
updated_date: 2025-10-13
type: note
link:
tags:
  - 10-2025
  - go
  - IT
---

# Tests


## Правила
Стандартные тесты в Golang пишутся с применением пакета `testing`. Тестовые функции должны начинаться с `Test`, сигнатура должна принимать один аргумент типа `*testing.T`:

```go
func TestSomething(t *testing.T) {
    // ...
}
```

Файл с тестами лучше называть так же, как и тестируемый файл, но с суффиксом `_test`. Например, если мы тестируем файл `main.go`, тесты должны быть в файле `main_test.go`. От правила с окончанием `_test` отступать нельзя.


## Подтесты
Если у вашего теста несколько логических частей, вы можете создавать подтесты с помощью `t.Run`. Это упрощает отслеживание ошибок и облегчает понимание, какая часть теста не прошла:

```go
func TestConcurrentFunctionality(t *testing.T) {
    t.Run("Increment", testIncrement)
    t.Run("Decrement", testDecrement)
}

func testIncrement(t *testing.T) {
    // тело теста инкрементации...
}

func testDecrement(t *testing.T) {
    // тело теста декрементации...
}
```


## Запуск тестов

Команда `go test` принимает несколько флагов, которые позволяют конфигурировать запуск тестов в пакете. Давайте попробуем выполнить её в вашем проекте.

```go
package printer

import "testing"

func TestPrintHello(t *testing.T) {
    got := PrintHello("Igor")
    expected := "Hello, Igor!"

    if got != expected {
    t.Fatalf(`PrintHello("Igor") = %q, want %q`, got, expected)
    }
}
```

```go
go test -v
```

## Кэширование результатов тестов

Команда `go clean` удаляет временные файлы, которые были созданы во время сборки проекта. Она также удаляет кэш результатов тестов. Давайте попробуем запустить тесты после очистки кэша:

```go
go clean -cache
go test -v
```

Теперь мы видим, что тесты выполняются:

ivan.ivanov ~/project $ go test -v
=== RUN   TestSomething
--- FAIL: TestSomething (0.00s)
FAIL
exit status 1
FAIL    module3_1-lesson        2.285s

## Флаг -count

```go
go test -v -count=3
```
Запускает тест несколько раз


## Запуск отдельных тестов

Для запуска отдельных тестов по имени используется опция `-run`. Например, если мы хотим запустить только тест `TestPrintHello`, можем использовать такую команду:

```go
go test -v -run=TestPrintHello
```

## Опция для запуска всех тестов в пакете

Опция `./...` позволяет запускать тесты во всех пакетах внутри текущего модуля. Давайте попробуем её в деле:

```go
go test -v ./...
```

## Table driven

Table driven testing — это принцип тестирования, который позволяет выполнять несколько тестовых случаев с различным набором тестовых данных. Вот пример:

```go
func TestSum(t *testing.T) {
        // набор тестов
        cases := []struct {
            // имя теста
            name string
            // значения на вход тестируемой функции
            values []int
            // желаемый результат
            want int
        }{
            // тестовые данные № 1
            {
                name: "positive values",
                values: []int{1, 2, 3},
                want: 6,
            },
            // тестовые данные № 2
            {
                name: "mixed values",
                values: []int{-1, 2, -3},
                want: -2,
            },
        }
        // перебор всех тестов
        for _, tc := range cases {
            tc := tc
            // запуск отдельного теста
            t.Run(tc.name, func(t *testing.T) {
                // тестируем функцию Sum
                got := Sum(tc.values...)
                // проверим полученное значение
                if got != tc.want {
                        t.Errorf("Sum(%v) = %v; want %v", tc.values, got, tc.want)
                }
            })
        }
}
```

# Итого
- `-v` — выводит подробную информацию о тестах
- `go clean` — очищает кэш результатов тестов
- `-count=1` — запускает тесты нужное количество раз
- `-run` — запускает тесты по имени
- `./...` — запускает тесты во всех пакетах внутри текущего модуля
- `-cover` — выводит информацию о покрытии кода тестами

**Сегодня мы изучили основы тестирования в Go, включая написание тестов с помощью пакета `testing` и их запуск через `go test` с разными флагами. Тесты проверяют корректность написанного вами кода, а флаги вроде `-v` и `-cover` помогают анализировать их выполнение.**